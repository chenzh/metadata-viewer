<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÁÇπÊ†ºÊ£ã - No WiFi Games</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: white;
            padding: 20px;
        }
        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            color: #e94560;
            text-decoration: none;
            font-size: 1.1rem;
        }
        h1 { margin-top: 50px; font-size: 2.2rem; margin-bottom: 10px; }
        .scores {
            display: flex;
            gap: 40px;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }
        .player1 { color: #e94560; }
        .player2 { color: #4caf50; }
        .current-turn {
            font-size: 1.1rem;
            margin-bottom: 15px;
            padding: 8px 20px;
            border-radius: 20px;
            background: rgba(255,255,255,0.1);
        }
        #gameBoard {
            display: grid;
            gap: 0;
            background: #333;
            padding: 10px;
            border-radius: 10px;
        }
        .cell {
            width: 40px;
            height: 40px;
            position: relative;
        }
        .dot {
            position: absolute;
            width: 10px;
            height: 10px;
            background: white;
            border-radius: 50%;
            z-index: 2;
        }
        .h-line, .v-line {
            position: absolute;
            background: #555;
            cursor: pointer;
            transition: all 0.2s;
        }
        .h-line:hover, .v-line:hover { background: #888; }
        .h-line {
            width: 40px;
            height: 10px;
            top: 0;
            left: 5px;
        }
        .v-line {
            width: 10px;
            height: 40px;
            left: 0;
            top: 5px;
        }
        .h-line.active { background: #e94560; cursor: default; }
        .v-line.active { background: #e94560; cursor: default; }
        .h-line.active.p2 { background: #4caf50; }
        .v-line.active.p2 { background: #4caf50; }
        .box {
            position: absolute;
            width: 40px;
            height: 40px;
            top: 5px;
            left: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            z-index: 1;
        }
        .box.p1 { color: #e94560; }
        .box.p2 { color: #4caf50; }
        .controls {
            margin-top: 30px;
            display: flex;
            gap: 15px;
        }
        button {
            padding: 12px 30px;
            background: #e94560;
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
        }
        .winner {
            font-size: 1.5rem;
            margin-top: 20px;
            opacity: 0;
            transition: opacity 0.5s;
        }
        .winner.show { opacity: 1; }
    </style>
</head>
<body>
    <a href="../index.html" class="back-btn">‚Üê ËøîÂõû</a>
    <h1>‚¨ú ÁÇπÊ†ºÊ£ã</h1>
    
    <div class="scores">
        <div class="player1">Áé©ÂÆ∂ 1 (P1): <span id="score1">0</span></div>
        <div class="player2">Áé©ÂÆ∂ 2 (P2): <span id="score2">0</span></div>
    </div>
    
    <div class="current-turn" id="turn">ËΩÆÂà∞: Áé©ÂÆ∂ 1</div>
    
    <div id="gameBoard"></div>
    
    <div class="winner" id="winner"></div>
    
    <div class="controls">
        <button onclick="initGame()">Êñ∞Ê∏∏Êàè</button>
    </div>

    <script>
        const ROWS = 5, COLS = 5;
        let hLines = [], vLines = [], boxes = [], currentPlayer, scores, gameOver;
        
        function initGame() {
            hLines = Array(ROWS + 1).fill(null).map(() => Array(COLS).fill(false));
            vLines = Array(ROWS).fill(null).map(() => Array(COLS + 1).fill(false));
            boxes = Array(ROWS).fill(null).map(() => Array(COLS).fill(0));
            currentPlayer = 1;
            scores = { 1: 0, 2: 0 };
            gameOver = false;
            
            document.getElementById('score1').textContent = '0';
            document.getElementById('score2').textContent = '0';
            document.getElementById('turn').textContent = 'ËΩÆÂà∞: Áé©ÂÆ∂ 1';
            document.getElementById('turn').style.background = 'rgba(233, 69, 96, 0.3)';
            document.getElementById('winner').classList.remove('show');
            
            renderBoard();
        }
        
        function renderBoard() {
            const container = document.getElementById('gameBoard');
            container.innerHTML = '';
            container.style.gridTemplateColumns = `repeat(${COLS + 1}, 40px)`;
            container.style.gridTemplateRows = `repeat(${ROWS + 1}, 40px)`;
            
            for (let r = 0; r <= ROWS; r++) {
                for (let c = 0; c <= COLS; c++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    
                    // Dot
                    const dot = document.createElement('div');
                    dot.className = 'dot';
                    dot.style.left = '0px';
                    dot.style.top = '0px';
                    cell.appendChild(dot);
                    
                    // Horizontal line
                    if (c < COLS) {
                        const hLine = document.createElement('div');
                        hLine.className = 'h-line';
                        if (hLines[r][c]) {
                            hLine.classList.add('active');
                            if (getLinePlayer('h', r, c) === 2) hLine.classList.add('p2');
                        } else if (!gameOver) {
                            hLine.onclick = () => clickLine('h', r, c);
                        }
                        cell.appendChild(hLine);
                    }
                    
                    // Vertical line
                    if (r < ROWS) {
                        const vLine = document.createElement('div');
                        vLine.className = 'v-line';
                        if (vLines[r][c]) {
                            vLine.classList.add('active');
                            if (getLinePlayer('v', r, c) === 2) vLine.classList.add('p2');
                        } else if (!gameOver) {
                            vLine.onclick = () => clickLine('v', r, c);
                        }
                        cell.appendChild(vLine);
                    }
                    
                    // Box ownership
                    if (r < ROWS && c < COLS && boxes[r][c] !== 0) {
                        const box = document.createElement('div');
                        box.className = 'box p' + boxes[r][c];
                        box.textContent = 'P' + boxes[r][c];
                        cell.appendChild(box);
                    }
                    
                    container.appendChild(cell);
                }
            }
        }
        
        function getLinePlayer(type, r, c) {
            // Simplified - just track which player made the move
            return currentPlayer === 1 ? 2 : 1; // Previous player
        }
        
        function clickLine(type, r, c) {
            if (gameOver) return;
            
            if (type === 'h' && hLines[r][c]) return;
            if (type === 'v' && vLines[r][c]) return;
            
            if (type === 'h') hLines[r][c] = true;
            else vLines[r][c] = true;
            
            let boxesFilled = checkBoxes();
            
            if (boxesFilled === 0) {
                currentPlayer = currentPlayer === 1 ? 2 : 1;
            }
            
            updateUI();
            renderBoard();
            checkGameOver();
        }
        
        function checkBoxes() {
            let filled = 0;
            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    if (boxes[r][c] === 0 &&
                        hLines[r][c] && hLines[r+1][c] &&
                        vLines[r][c] && vLines[r][c+1]) {
                        boxes[r][c] = currentPlayer;
                        scores[currentPlayer]++;
                        filled++;
                    }
                }
            }
            return filled;
        }
        
        function updateUI() {
            document.getElementById('score1').textContent = scores[1];
            document.getElementById('score2').textContent = scores[2];
            document.getElementById('turn').textContent = `ËΩÆÂà∞: Áé©ÂÆ∂ ${currentPlayer}`;
            document.getElementById('turn').style.background = currentPlayer === 1 ? 
                'rgba(233, 69, 96, 0.3)' : 'rgba(76, 175, 80, 0.3)';
        }
        
        function checkGameOver() {
            const totalLines = (ROWS + 1) * COLS + ROWS * (COLS + 1);
            const filledLines = hLines.flat().filter(x=>x).length + vLines.flat().filter(x=>x).length;
            
            if (filledLines === totalLines) {
                gameOver = true;
                const winner = document.getElementById('winner');
                if (scores[1] > scores[2]) {
                    winner.textContent = 'üéâ Áé©ÂÆ∂ 1 Ëé∑ËÉúÔºÅ';
                    winner.style.color = '#e94560';
                } else if (scores[2] > scores[1]) {
                    winner.textContent = 'üéâ Áé©ÂÆ∂ 2 Ëé∑ËÉúÔºÅ';
                    winner.style.color = '#4caf50';
                } else {
                    winner.textContent = 'ü§ù Âπ≥Â±ÄÔºÅ';
                    winner.style.color = '#888';
                }
                winner.classList.add('show');
            }
        }
        
        initGame();
    </script>
</body>
</html>