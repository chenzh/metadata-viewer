<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¥¿è’™è®°å¿†æ¸¸æˆ - No WiFi Games</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-user-select: none; user-select: none; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: white;
            padding: 20px;
        }
        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            color: #e94560;
            text-decoration: none;
            font-size: 1.1rem;
        }
        h1 { margin-top: 60px; font-size: 2.2rem; margin-bottom: 10px; }
        .subtitle { color: #888; margin-bottom: 30px; }
        .game-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 30px 0;
        }
        .color-btn {
            width: 120px;
            height: 120px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.1s;
            opacity: 0.7;
        }
        .color-btn.active { opacity: 1; transform: scale(1.05); filter: brightness(1.5); }
        .color-btn.green { background: #4caf50; }
        .color-btn.red { background: #f44336; }
        .color-btn.yellow { background: #ffeb3b; }
        .color-btn.blue { background: #2196f3; }
        .status {
            font-size: 1.5rem;
            margin: 20px 0;
            min-height: 40px;
            text-align: center;
        }
        .score-display {
            font-size: 1.3rem;
            color: #888;
        }
        .score-display span { color: #e94560; font-size: 1.5rem; }
        #startBtn {
            padding: 15px 50px;
            background: #e94560;
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 1.3rem;
            cursor: pointer;
            margin-top: 20px;
        }
        @media (max-width: 400px) {
            .color-btn { width: 100px; height: 100px; }
        }
    </style>
</head>
<body>
    <a href="../index.html" class="back-btn">â† è¿”å›</a>
    <h1>ğŸµ Simon Says</h1>
    <p class="subtitle">è®°ä½å¹¶é‡å¤äº®èµ·çš„é¢œè‰²åºåˆ—</p>
    
    <div class="score-display">å½“å‰å…³å¡: <span id="level">0</span> | æœ€é«˜åˆ†: <span id="highScore">0</span></div>
    
    <div class="game-container">
        <button class="color-btn green" data-color="0"></button>
        <button class="color-btn red" data-color="1"></button>
        <button class="color-btn yellow" data-color="2"></button>
        <button class="color-btn blue" data-color="3"></button>
    </div>
    
    <div class="status" id="status">ç‚¹å‡»å¼€å§‹æ¸¸æˆ</div>
    <button id="startBtn" onclick="startGame()">å¼€å§‹æ¸¸æˆ</button>

    <script>
    // ç¦æ­¢é•¿æŒ‰å¤åˆ¶èœå•
    document.addEventListener('contextmenu', e => e.preventDefault());
        const colors = ['green', 'red', 'yellow', 'blue'];
        const tones = [329.63, 261.63, 220.00, 164.81];
        let sequence = [], playerSequence = [], level = 0, highScore = 0;
        let isPlaying = false, canInput = false;
        let audioCtx;
        
        const colorBtns = document.querySelectorAll('.color-btn');
        const status = document.getElementById('status');
        const startBtn = document.getElementById('startBtn');
        
        colorBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                if (canInput) playerClick(parseInt(btn.dataset.color));
            });
        });
        
        function initAudio() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        }
        
        function playTone(freq, duration = 300) {
            if (!audioCtx) initAudio();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.frequency.value = freq;
            gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration / 1000);
            osc.start();
            osc.stop(audioCtx.currentTime + duration / 1000);
        }
        
        function playErrorTone() {
            if (!audioCtx) initAudio();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.frequency.value = 150;
            osc.type = 'sawtooth';
            gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        }
        
        function flashButton(colorIndex, duration = 400) {
            const btn = colorBtns[colorIndex];
            btn.classList.add('active');
            playTone(tones[colorIndex], duration);
            setTimeout(() => btn.classList.remove('active'), duration);
        }
        
        async function playSequence() {
            canInput = false;
            status.textContent = 'ä»”ç»†çœ‹...';
            
            await new Promise(r => setTimeout(r, 800));
            
            for (let i = 0; i < sequence.length; i++) {
                flashButton(sequence[i]);
                await new Promise(r => setTimeout(r, 600));
            }
            
            canInput = true;
            status.textContent = 'è½®åˆ°ä½ äº†ï¼';
        }
        
        function startGame() {
            initAudio();
            sequence = [];
            playerSequence = [];
            level = 0;
            isPlaying = true;
            startBtn.style.display = 'none';
            nextLevel();
        }
        
        function nextLevel() {
            level++;
            playerSequence = [];
            document.getElementById('level').textContent = level;
            sequence.push(Math.floor(Math.random() * 4));
            playSequence();
        }
        
        function playerClick(color) {
            flashButton(color, 200);
            playerSequence.push(color);
            
            const currentIndex = playerSequence.length - 1;
            if (playerSequence[currentIndex] !== sequence[currentIndex]) {
                gameOver();
                return;
            }
            
            if (playerSequence.length === sequence.length) {
                canInput = false;
                status.textContent = 'âœ“ æ­£ç¡®ï¼';
                setTimeout(nextLevel, 1000);
            }
        }
        
        function gameOver() {
            isPlaying = false;
            canInput = false;
            playErrorTone();
            
            if (level > highScore) {
                highScore = level - 1;
                document.getElementById('highScore').textContent = highScore;
                status.textContent = `ğŸ‰ æ–°çºªå½•ï¼ä½ å®Œæˆäº† ${level - 1} å…³`;
            } else {
                status.textContent = `æ¸¸æˆç»“æŸï¼ä½ å®Œæˆäº† ${level - 1} å…³`;
            }
            
            startBtn.textContent = 'å†ç©ä¸€æ¬¡';
            startBtn.style.display = 'inline-block';
        }
    </script>
</body>
</html>